{"version":3,"sources":["ng://ngx-echarts/lib/change-filter.ts","ng://ngx-echarts/lib/ngx-echarts.directive.ts","ng://ngx-echarts/lib/ngx-echarts.module.ts"],"names":["ChangeFilter","_changes","this","of","changes","prototype","notEmpty","key","value","currentValue","EMPTY","has","notFirst","isFirstChange","notFirstAndEmpty","NgxEchartsDirective","el","ngZone","autoResize","loadingType","detectEventChanges","chartInit","EventEmitter","chartClick","createLazyEvent","chartDblClick","chartMouseDown","chartMouseMove","chartMouseUp","chartMouseOver","chartMouseOut","chartGlobalOut","chartContextMenu","chartLegendSelectChanged","chartLegendSelected","chartLegendUnselected","chartLegendScroll","chartDataZoom","chartDataRangeSelected","chartTimelineChanged","chartTimelinePlayChanged","chartRestore","chartDataViewChanged","chartMagicTypeChanged","chartPieSelectChanged","chartPieSelected","chartPieUnselected","chartMapSelectChanged","chartMapSelected","chartMapUnselected","chartAxisAreaSelected","chartFocusNodeAdjacency","chartUnfocusNodeAdjacency","chartBrush","chartBrushSelected","chartRendered","chartFinished","currentOffsetWidth","currentOffsetHeight","ngOnChanges","_this","filter","subscribe","opt","onOptionsChange","setOption","v","toggleLoading","refreshChart","ngOnInit","resizeSub","fromEvent","window","pipe","debounceTime","innerWidth","currentWindowWidth","nativeElement","offsetWidth","offsetHeight","resize","ngOnDestroy","unsubscribe","dispose","ngDoCheck","chart","ngAfterViewInit","setTimeout","initChart","loading","showLoading","loadingOpts","hideLoading","option","opts","createChart","dom","getComputedStyle","prop","getPropertyValue","style","height","runOutsideAngular","init","theme","initOpts","options","merge","emit","eventName","switchMap","Observable","observer","on","data","run","next","off","Directive","args","selector","ElementRef","NgZone","Input","Output","NgxEchartsModule","NgModule","imports","declarations","exports"],"mappings":"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","sourcesContent":["import { SimpleChanges } from '@angular/core';\nimport { Observable, of, EMPTY } from 'rxjs';\n\nexport class ChangeFilter {\n  constructor(private _changes: SimpleChanges) { }\n\n  static of(changes: SimpleChanges) {\n    return new ChangeFilter(changes);\n  }\n\n  notEmpty<T>(key: string): Observable<T> {\n    if (this._changes[key]) {\n      const value: T = this._changes[key].currentValue;\n\n      if (value !== undefined && value !== null) {\n        return of(value);\n      }\n    }\n    return EMPTY;\n  }\n\n  has<T>(key: string): Observable<T> {\n    if (this._changes[key]) {\n      const value: T = this._changes[key].currentValue;\n      return of(value);\n    }\n    return EMPTY;\n  }\n\n  notFirst<T>(key: string): Observable<T> {\n    if (this._changes[key] && !this._changes[key].isFirstChange()) {\n      const value: T = this._changes[key].currentValue;\n      return of(value);\n    }\n    return EMPTY;\n  }\n\n  notFirstAndEmpty<T>(key: string): Observable<T> {\n    if (this._changes[key] && !this._changes[key].isFirstChange()) {\n      const value: T = this._changes[key].currentValue;\n\n      if (value !== undefined && value !== null) {\n        return of(value);\n      }\n    }\n    return EMPTY;\n  }\n}\n","import { AfterViewInit, Directive, DoCheck, ElementRef, EventEmitter, Input, NgZone, OnChanges, OnDestroy, OnInit, Output, SimpleChanges } from '@angular/core';\nimport { EChartOption, ECharts, init } from 'echarts';\nimport { fromEvent, Observable, Subscription } from 'rxjs';\nimport { debounceTime, switchMap } from 'rxjs/operators';\nimport { ChangeFilter } from './change-filter';\n\n@Directive({\n  selector: 'echarts, [echarts]',\n})\nexport class NgxEchartsDirective implements OnChanges, OnDestroy, OnInit, DoCheck, AfterViewInit {\n  @Input() options: EChartOption;\n  @Input() theme: string;\n  @Input() loading: boolean;\n  @Input() initOpts: {\n    devicePixelRatio?: number\n    renderer?: string\n    width?: number | string\n    height?: number | string\n  };\n  @Input() merge: EChartOption;\n  @Input() autoResize = true;\n  @Input() loadingType = 'default';\n  @Input() loadingOpts: object;\n  @Input() detectEventChanges = true; // deprecated, left for compatibility reasons to avoid triggering major version\n\n  // ngx-echarts events\n  @Output() chartInit = new EventEmitter<ECharts>();\n\n  // echarts mouse events\n  @Output() chartClick = this.createLazyEvent('click');\n  @Output() chartDblClick = this.createLazyEvent('dblclick');\n  @Output() chartMouseDown = this.createLazyEvent('mousedown');\n  @Output() chartMouseMove = this.createLazyEvent('mousemove');\n  @Output() chartMouseUp = this.createLazyEvent('mouseup');\n  @Output() chartMouseOver = this.createLazyEvent('mouseover');\n  @Output() chartMouseOut = this.createLazyEvent('mouseout');\n  @Output() chartGlobalOut = this.createLazyEvent('globalout');\n  @Output() chartContextMenu = this.createLazyEvent('contextmenu');\n\n  // echarts mouse events\n  @Output() chartLegendSelectChanged = this.createLazyEvent('legendselectchanged');\n  @Output() chartLegendSelected = this.createLazyEvent('legendselected');\n  @Output() chartLegendUnselected = this.createLazyEvent('legendunselected');\n  @Output() chartLegendScroll = this.createLazyEvent('legendscroll');\n  @Output() chartDataZoom = this.createLazyEvent('datazoom');\n  @Output() chartDataRangeSelected = this.createLazyEvent('datarangeselected');\n  @Output() chartTimelineChanged = this.createLazyEvent('timelinechanged');\n  @Output() chartTimelinePlayChanged = this.createLazyEvent('timelineplaychanged');\n  @Output() chartRestore = this.createLazyEvent('restore');\n  @Output() chartDataViewChanged = this.createLazyEvent('dataviewchanged');\n  @Output() chartMagicTypeChanged = this.createLazyEvent('magictypechanged');\n  @Output() chartPieSelectChanged = this.createLazyEvent('pieselectchanged');\n  @Output() chartPieSelected = this.createLazyEvent('pieselected');\n  @Output() chartPieUnselected = this.createLazyEvent('pieunselected');\n  @Output() chartMapSelectChanged = this.createLazyEvent('mapselectchanged');\n  @Output() chartMapSelected = this.createLazyEvent('mapselected');\n  @Output() chartMapUnselected = this.createLazyEvent('mapunselected');\n  @Output() chartAxisAreaSelected = this.createLazyEvent('axisareaselected');\n  @Output() chartFocusNodeAdjacency = this.createLazyEvent('focusnodeadjacency');\n  @Output() chartUnfocusNodeAdjacency = this.createLazyEvent('unfocusnodeadjacency');\n  @Output() chartBrush = this.createLazyEvent('brush');\n  @Output() chartBrushSelected = this.createLazyEvent('brushselected');\n  @Output() chartRendered = this.createLazyEvent('rendered');\n  @Output() chartFinished = this.createLazyEvent('finished');\n\n  private chart: ECharts;\n  private currentOffsetWidth = 0;\n  private currentOffsetHeight = 0;\n  private currentWindowWidth: number;\n  private resizeSub: Subscription;\n\n  constructor(private el: ElementRef, private ngZone: NgZone) { }\n\n  ngOnChanges(changes: SimpleChanges) {\n    const filter = ChangeFilter.of(changes);\n    filter.notFirstAndEmpty<any>('options').subscribe(opt => this.onOptionsChange(opt));\n    filter.notFirstAndEmpty<any>('merge').subscribe(opt => this.setOption(opt));\n    filter.has<boolean>('loading').subscribe(v => this.toggleLoading(!!v));\n    filter.notFirst<string>('theme').subscribe(() => this.refreshChart());\n  }\n\n  ngOnInit() {\n    this.resizeSub = fromEvent(window, 'resize').pipe(debounceTime(50)).subscribe(() => {\n      if (this.autoResize && window.innerWidth !== this.currentWindowWidth) {\n        this.currentWindowWidth = window.innerWidth;\n        this.currentOffsetWidth = this.el.nativeElement.offsetWidth;\n        this.currentOffsetHeight = this.el.nativeElement.offsetHeight;\n        this.resize();\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    if (this.resizeSub) {\n      this.resizeSub.unsubscribe();\n    }\n    this.dispose();\n  }\n\n  ngDoCheck() {\n    // No heavy work in DoCheck!\n    if (this.chart && this.autoResize) {\n      const offsetWidth = this.el.nativeElement.offsetWidth;\n      const offsetHeight = this.el.nativeElement.offsetHeight;\n\n      if (this.currentOffsetWidth !== offsetWidth || this.currentOffsetHeight !== offsetHeight) {\n        this.currentOffsetWidth = offsetWidth;\n        this.currentOffsetHeight = offsetHeight;\n        this.resize();\n      }\n    }\n  }\n\n  ngAfterViewInit() {\n    setTimeout(() => this.initChart());\n  }\n\n  private dispose() {\n    if (this.chart) {\n      this.chart.dispose();\n      this.chart = null;\n    }\n  }\n\n  private resize() {\n    if (this.chart) {\n      this.chart.resize();\n    }\n  }\n\n  private toggleLoading(loading: boolean) {\n    if (this.chart) {\n      loading ? this.chart.showLoading(this.loadingType, this.loadingOpts) : this.chart.hideLoading();\n    }\n  }\n\n  private setOption(option: any, opts?: any) {\n    if (this.chart) {\n      this.chart.setOption(option, opts);\n    }\n  }\n\n  private refreshChart() {\n    this.dispose();\n    this.initChart();\n  }\n\n  private createChart() {\n    this.currentWindowWidth = window.innerWidth;\n    this.currentOffsetWidth = this.el.nativeElement.offsetWidth;\n    this.currentOffsetHeight = this.el.nativeElement.offsetHeight;\n    const dom = this.el.nativeElement;\n\n    if (window && window.getComputedStyle) {\n      const prop = window.getComputedStyle(dom, null).getPropertyValue('height');\n      if ((!prop || prop === '0px') &&\n        (!dom.style.height || dom.style.height === '0px')) {\n        dom.style.height = '400px';\n      }\n    }\n\n    return this.ngZone.runOutsideAngular(() => init(dom, this.theme, this.initOpts));\n  }\n\n  private initChart() {\n    this.onOptionsChange(this.options);\n\n    if (this.merge && this.chart) {\n      this.setOption(this.merge);\n    }\n  }\n\n  private onOptionsChange(opt: EChartOption) {\n    if (opt) {\n      if (!this.chart) {\n        this.chart = this.createChart();\n        this.chartInit.emit(this.chart);\n      }\n\n      this.chart.setOption(this.options, true);\n    }\n  }\n\n  // allows to lazily bind to only those events that are requested through the `@Output` by parent components\n  // see https://stackoverflow.com/questions/51787972/optimal-reentering-the-ngzone-from-eventemitter-event for more info\n  private createLazyEvent<T>(eventName: string): EventEmitter<T> {\n    return this.chartInit.pipe(\n      switchMap((chart: ECharts) => new Observable(observer => {\n        chart.on(eventName, (data: T) => this.ngZone.run(() => observer.next(data)));\n        return () => chart.off(eventName);\n      }))\n    ) as EventEmitter<T>;\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { NgxEchartsDirective } from './ngx-echarts.directive';\n\n@NgModule({\n  imports: [],\n  declarations: [\n    NgxEchartsDirective\n  ],\n  exports: [\n    NgxEchartsDirective\n  ]\n})\nexport class NgxEchartsModule { }\n"]}