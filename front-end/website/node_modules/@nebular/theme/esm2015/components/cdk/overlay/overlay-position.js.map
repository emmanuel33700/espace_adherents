{"version":3,"file":"overlay-position.js","sourceRoot":"","sources":["../../../../../../../.ng_build/theme/components/cdk/overlay/overlay-position.ts"],"names":[],"mappings":"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","sourcesContent":["import { ElementRef, Inject, Injectable } from '@angular/core';\n\nimport { map } from 'rxjs/operators';\nimport { Observable } from 'rxjs';\n\nimport { NB_DOCUMENT } from '../../../theme.options';\nimport {\n  NbConnectedOverlayPositionChange,\n  NbConnectedPosition,\n  NbConnectionPositionPair,\n  NbFlexibleConnectedPositionStrategy,\n  NbOverlayPositionBuilder,\n  NbOverlayRef,\n  NbPositionStrategy,\n} from './mapping';\nimport { NbPlatform } from '../platform/platform-service';\nimport { NbOverlayContainerAdapter } from '../adapter/overlay-container-adapter';\nimport { NbViewportRulerAdapter } from '../adapter/viewport-ruler-adapter';\nimport { NbGlobalLogicalPosition } from './position-helper';\nimport { GlobalPositionStrategy } from '@angular/cdk/overlay';\n\n\nexport enum NbAdjustment {\n  NOOP = 'noop',\n  CLOCKWISE = 'clockwise',\n  COUNTERCLOCKWISE = 'counterclockwise',\n  VERTICAL = 'vertical',\n  HORIZONTAL = 'horizontal',\n}\n\n// tslint:disable-next-line:max-line-length\nexport type NbPositionValues = 'top' | 'bottom' | 'left' | 'right' | 'start' | 'end' | 'top-end' | 'top-start' | 'bottom-end' | 'bottom-start' | 'end-top' | 'end-bottom' | 'start-top' | 'start-bottom';\nexport enum NbPosition {\n  TOP = 'top',\n  BOTTOM = 'bottom',\n  LEFT = 'left',\n  RIGHT = 'right',\n  START = 'start',\n  END = 'end',\n  TOP_END = 'top-end',\n  TOP_START = 'top-start',\n  BOTTOM_END = 'bottom-end',\n  BOTTOM_START = 'bottom-start',\n  END_TOP = 'end-top',\n  END_BOTTOM = 'end-bottom',\n  START_TOP = 'start-top',\n  START_BOTTOM = 'start-bottom',\n}\n\nconst POSITIONS = {\n  [NbPosition.RIGHT](offset) {\n    return { originX: 'end', originY: 'center', overlayX: 'start', overlayY: 'center', offsetX: offset };\n  },\n  [NbPosition.BOTTOM](offset) {\n    return { originX: 'center', originY: 'bottom', overlayX: 'center', overlayY: 'top', offsetY: offset };\n  },\n  [NbPosition.LEFT](offset) {\n    return { originX: 'start', originY: 'center', overlayX: 'end', overlayY: 'center', offsetX: -offset };\n  },\n  [NbPosition.TOP](offset) {\n    return { originX: 'center', originY: 'top', overlayX: 'center', overlayY: 'bottom', offsetY: -offset };\n  },\n  [NbPosition.START](offset) {\n    return this[NbPosition.LEFT](offset);\n  },\n  [NbPosition.END](offset) {\n    return this[NbPosition.RIGHT](offset);\n  },\n  [NbPosition.END_TOP](offset) {\n    return { originX: 'end', originY: 'bottom', overlayX: 'start', overlayY: 'bottom', offsetX: offset };\n  },\n  [NbPosition.END_BOTTOM](offset) {\n    return { originX: 'end', originY: 'top', overlayX: 'start', overlayY: 'top', offsetX: offset };\n  },\n  [NbPosition.BOTTOM_START](offset) {\n    return { originX: 'end', originY: 'bottom', overlayX: 'end', overlayY: 'top', offsetY: offset };\n  },\n  [NbPosition.BOTTOM_END](offset) {\n    return { originX: 'start', originY: 'bottom', overlayX: 'start', overlayY: 'top', offsetY: offset };\n  },\n  [NbPosition.START_TOP](offset) {\n    return { originX: 'start', originY: 'bottom', overlayX: 'end', overlayY: 'bottom', offsetX: -offset };\n  },\n  [NbPosition.START_BOTTOM](offset) {\n    return { originX: 'start', originY: 'top', overlayX: 'end', overlayY: 'top', offsetX: -offset };\n  },\n  [NbPosition.TOP_START](offset) {\n    return { originX: 'end', originY: 'top', overlayX: 'end', overlayY: 'bottom', offsetY: -offset };\n  },\n  [NbPosition.TOP_END](offset) {\n    return { originX: 'start', originY: 'top', overlayX: 'start', overlayY: 'bottom', offsetY: -offset };\n  },\n};\n\nconst COUNTER_CLOCKWISE_POSITIONS = [\n  NbPosition.TOP,\n  NbPosition.TOP_END,\n  NbPosition.TOP_START,\n  NbPosition.START,\n  NbPosition.START_TOP,\n  NbPosition.START_BOTTOM,\n  NbPosition.BOTTOM,\n  NbPosition.BOTTOM_START,\n  NbPosition.BOTTOM_END,\n  NbPosition.END,\n  NbPosition.END_BOTTOM,\n  NbPosition.END_TOP,\n];\nconst CLOCKWISE_POSITIONS = [\n  NbPosition.TOP,\n  NbPosition.TOP_START,\n  NbPosition.TOP_END,\n  NbPosition.END,\n  NbPosition.END_TOP,\n  NbPosition.END_BOTTOM,\n  NbPosition.BOTTOM,\n  NbPosition.BOTTOM_END,\n  NbPosition.BOTTOM_START,\n  NbPosition.START,\n  NbPosition.START_BOTTOM,\n  NbPosition.START_TOP,\n];\nconst VERTICAL_POSITIONS = [NbPosition.BOTTOM, NbPosition.TOP];\nconst HORIZONTAL_POSITIONS = [NbPosition.START, NbPosition.END];\n\n\nfunction comparePositions(p1: NbConnectedPosition, p2: NbConnectedPosition): boolean {\n  return p1.originX === p2.originX\n    && p1.originY === p2.originY\n    && p1.overlayX === p2.overlayX\n    && p1.overlayY === p2.overlayY;\n}\n\n/**\n * The main idea of the adjustable connected strategy is to provide predefined set of positions for your overlay.\n * You have to provide adjustment and appropriate strategy will be chosen in runtime.\n * */\nexport class NbAdjustableConnectedPositionStrategy\n  extends NbFlexibleConnectedPositionStrategy implements NbPositionStrategy {\n\n  protected _position: NbPosition;\n  protected _offset: number = 15;\n  protected _adjustment: NbAdjustment;\n\n  protected appliedPositions: { key: NbPosition, connectedPosition: NbConnectedPosition }[];\n\n  readonly positionChange: Observable<NbPosition> = this.positionChanges.pipe(\n    map((positionChange: NbConnectedOverlayPositionChange) => positionChange.connectionPair),\n    map((connectionPair: NbConnectionPositionPair) => {\n      return this.appliedPositions.find(({ connectedPosition }) => {\n        return comparePositions(connectedPosition, connectionPair);\n      }).key;\n    }),\n  );\n\n  attach(overlayRef: NbOverlayRef) {\n    /**\n     * We have to apply positions before attach because super.attach() validates positions and crashes app\n     * if no positions provided.\n     * */\n    this.applyPositions();\n    super.attach(overlayRef);\n  }\n\n  apply() {\n    this.applyPositions();\n    super.apply();\n  }\n\n  position(position: NbPosition): this {\n    this._position = position;\n    return this;\n  }\n\n  adjustment(adjustment: NbAdjustment): this {\n    this._adjustment = adjustment;\n    return this;\n  }\n\n  offset(offset: number): this {\n    this._offset = offset;\n    return this;\n  }\n\n  protected applyPositions() {\n    const positions: NbPosition[] = this.createPositions();\n    this.persistChosenPositions(positions);\n    this.withPositions(this.appliedPositions.map(({ connectedPosition }) => connectedPosition));\n  }\n\n  protected createPositions(): NbPosition[] {\n    switch (this._adjustment) {\n      case NbAdjustment.NOOP:\n        return [ this._position ];\n      case NbAdjustment.CLOCKWISE:\n        return this.reorderPreferredPositions(CLOCKWISE_POSITIONS);\n      case NbAdjustment.COUNTERCLOCKWISE:\n        return this.reorderPreferredPositions(COUNTER_CLOCKWISE_POSITIONS);\n      case NbAdjustment.HORIZONTAL:\n        return this.reorderPreferredPositions(HORIZONTAL_POSITIONS);\n      case NbAdjustment.VERTICAL:\n        return this.reorderPreferredPositions(VERTICAL_POSITIONS);\n    }\n  }\n\n  protected persistChosenPositions(positions: NbPosition[]) {\n    this.appliedPositions = positions.map(position => ({\n      key: position,\n      connectedPosition: POSITIONS[position](this._offset),\n    }));\n  }\n\n  protected reorderPreferredPositions(positions: NbPosition[]): NbPosition[] {\n    // Physical positions should be mapped to logical as adjustments use logical positions.\n    const startPositionIndex = positions.indexOf(this.mapToLogicalPosition(this._position));\n    const firstPart = positions.slice(startPositionIndex);\n    const secondPart = positions.slice(0, startPositionIndex);\n    return firstPart.concat(secondPart);\n  }\n\n  protected mapToLogicalPosition(position: NbPosition): NbPosition {\n    if (position === NbPosition.LEFT) {\n      return NbPosition.START;\n    }\n    if (position === NbPosition.RIGHT) {\n      return NbPosition.END;\n    }\n\n    return position;\n  }\n}\n\nexport class NbGlobalPositionStrategy extends GlobalPositionStrategy {\n\n  position(position: NbGlobalLogicalPosition): this {\n    switch (position) {\n      case NbGlobalLogicalPosition.TOP_START:\n        return this.top().left();\n\n      case NbGlobalLogicalPosition.TOP_END:\n        return this.top().right();\n\n      case NbGlobalLogicalPosition.BOTTOM_START:\n        return this.bottom().left();\n\n      case NbGlobalLogicalPosition.BOTTOM_END:\n        return this.bottom().right();\n    }\n  }\n}\n\n@Injectable()\nexport class NbPositionBuilderService {\n  constructor(@Inject(NB_DOCUMENT) protected document,\n              protected viewportRuler: NbViewportRulerAdapter,\n              protected platform: NbPlatform,\n              protected positionBuilder: NbOverlayPositionBuilder,\n              protected overlayContainer: NbOverlayContainerAdapter) {\n  }\n\n  global(): NbGlobalPositionStrategy {\n    return new NbGlobalPositionStrategy();\n  }\n\n  connectedTo(elementRef: ElementRef): NbAdjustableConnectedPositionStrategy {\n    return new NbAdjustableConnectedPositionStrategy(\n      elementRef,\n      this.viewportRuler,\n      this.document,\n      this.platform,\n      this.overlayContainer,\n    )\n      .withFlexibleDimensions(false)\n      .withPush(false);\n  }\n}\n"]}